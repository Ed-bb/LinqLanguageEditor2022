# Editor imports

### Article

<!--Start-Of-TOC-->
      - [Note](#Note)
   - [Import syntax](#Import-syntax)
   - [Import the service provider](#Import-the-service-provider)
   - [Services](#Services)
   - [Other imports](#Other-imports)
   - [See also](#See-also)
<!--End-Of-TOC-->


08/05/2021

You can import a number of editor services, factories, and brokers that provide
your extension with different kinds of access to the core editor. For example,
you can import the ITextStructureNavigatorSelectorService to provide you with a
ITextStructureNavigator for a given content type. (This navigator allows you
perform different kinds of searches on a text buffer.)

To use an editor import, you import it as a field or property of a class that
exports a Managed Extensibility Framework component part.

### Note

For more information about the Managed Extensibility Framework, see [Managed
Extensibility Framework
(MEF)](https://docs.microsoft.com/en-us/dotnet/framework/mef/index).

## Import syntax

The following example shows how to import the editor options factory service.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ CSharp
[Import]
internal IEditorOptionsFactoryService EditorOptions { get; set; }
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

If you want to import the service as a field and not a property, you should set
it to null in the declaration in order to avoid the compiler warnings about not
assigning to a variable:

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ CSharp
[Import]
internal IEditorOptionsFactoryService m_editorOptions = null;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

For more examples of using imports, see the following walkthroughs:

-   [Walkthrough: Create a margin
    glyph](https://docs.microsoft.com/en-us/visualstudio/extensibility/walkthrough-creating-a-margin-glyph?view=vs-2022)

-   [Walkthrough: Customize the text
    view](https://docs.microsoft.com/en-us/visualstudio/extensibility/walkthrough-customizing-the-text-view?view=vs-2022)

-   [Walkthrough: Highlight
    text](https://docs.microsoft.com/en-us/visualstudio/extensibility/walkthrough-highlighting-text?view=vs-2022)

-   [Walkthrough: Display QuickInfo
    tooltips](https://docs.microsoft.com/en-us/visualstudio/extensibility/walkthrough-displaying-quickinfo-tooltips?view=vs-2022)

-   [Walkthrough: Display Signature
    Help](https://docs.microsoft.com/en-us/visualstudio/extensibility/walkthrough-displaying-signature-help?view=vs-2022)

-   [Walkthrough: Display statement
    completion](https://docs.microsoft.com/en-us/visualstudio/extensibility/walkthrough-displaying-statement-completion?view=vs-2022)

-   [Walkthrough: Display light bulb
    suggestions](https://docs.microsoft.com/en-us/visualstudio/extensibility/walkthrough-displaying-light-bulb-suggestions?view=vs-2022)

## Import the service provider

You can also import a SVsServiceProvider (found in the assembly
Microsoft.VisualStudio.Shell.Immutable.10.0) in the same way to get access to
Visual Studio services:

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ CSharp
[Import]
internal SVsServiceProvider ServiceProvider = null;
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

See [Walkthrough: Access the DTE object from an editor
extension](https://docs.microsoft.com/en-us/visualstudio/extensibility/walkthrough-accessing-the-dte-object-from-an-editor-extension?view=vs-2022)
for more information.

## Services

Editor services are generally single entities that provide a service and are
shared across multiple components.

| SERVICES                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Import                                                                                                                                                                  | Provides                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [IFileExtensionRegistryService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.utilities.ifileextensionregistryservice)                             | The relationship between file extensions and IContentType objects.                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| [IContentTypeRegistryService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.utilities.icontenttyperegistryservice)                                 | The collection of IContentType objects.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [IVsFontsAndColorsInformationService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.editor.ivsfontsandcolorsinformationservice)                    | [IVsFontsAndColorsInformation](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.editor.ivsfontsandcolorsinformation) objects.                                                                                                                                                                                                                                                                                                                                                                                            |
| [IVsEditorAdaptersFactoryService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.editor.ivseditoradaptersfactoryservice)                            | Many editor adapter objects:  [IVsCodeWindow](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.textmanager.interop.ivscodewindow)  [IVsTextBuffer](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.textmanager.interop.ivstextbuffer)  [IVsTextBufferCoordinator](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.textmanager.interop.ivstextbuffercoordinator)  [IVsTextView](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.textmanager.interop.ivstextview) |
| [IIncrementalSearchFactoryService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.incrementalsearch.iincrementalsearchfactoryservice)          | An IIncrementalSearch object for a given text view.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [ITextBufferFactoryService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.itextbufferfactoryservice)                                          | An ITextBuffer.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [ITextDocumentFactoryService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.itextdocumentfactoryservice)                                      | An ITextDocument.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [IDifferenceService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.differencing.idifferenceservice)                                           | An IDifferenceCollection\<T\> of differences.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [IHierarchicalStringDifferenceService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.differencing.ihierarchicalstringdifferenceservice)       | An IHierarchicalDifferenceCollection of differences.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [IProjectionBufferFactoryService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.projection.iprojectionbufferfactoryservice)                   | An IProjectionBuffer or an IElisionBuffer.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [IBufferGraphFactoryService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.projection.ibuffergraphfactoryservice)                             | An IBufferGraph for a set of ITextBuffer objects.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [IClassifierAggregatorService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.classification.iclassifieraggregatorservice)                     | An IClassifier for a ITextBuffer.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [IViewClassifierAggregatorService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.classification.iviewclassifieraggregatorservice)             | An IClassifier for a ITextView.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [IClassificationFormatMapService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.classification.iclassificationformatmapservice)               | An IClassificationFormatMap for a ITextView.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [IEditorFormatMapService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.classification.ieditorformatmapservice)                               | An IEditorFormatMap for a ITextView.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [IClassificationTypeRegistryService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.classification.iclassificationtyperegistryservice)         | Maintains the collection of IClassificationType objects.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [IBufferTagAggregatorFactoryService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.tagging.ibuffertagaggregatorfactoryservice)                | An ITagAggregator\<T\> for a text buffer.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [IViewTagAggregatorFactoryService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.tagging.iviewtagaggregatorfactoryservice)                    | An ITagAggregator\<T\> for a text view.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [IEditorOptionsFactoryService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.editor.ieditoroptionsfactoryservice)                             | The IEditorOptions for the specified scope.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| [IScrollMapFactoryService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.editor.iscrollmapfactoryservice)                                     | An IScrollMap for a text view.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [ISmartIndentationService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.editor.ismartindentationservice)                                     | An ISmartIndent for a ITextView.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [ISmartIndentationService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.editor.ismartindentationservice)                                     | Gets the automatic indentation through the ISmartIndentProvider objects.                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [ITextEditorFactoryService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.editor.itexteditorfactoryservice)                                   | Manages the IWpfTextViewHost for a IWpfTextView.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [IFormattedTextSourceFactoryService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.formatting.iformattedtextsourcefactoryservice)             | An IFormattedLineSource.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [IRtfBuilderService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.formatting.irtfbuilderservice)                                             | Generates RTF-formatted text from a set of snapshot spans.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [ITextAndAdornmentSequencerFactoryService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.formatting.itextandadornmentsequencerfactoryservice) | An ITextAndAdornmentSequencer for an ITextView.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [ITextParagraphPropertiesFactoryService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.formatting.itextparagraphpropertiesfactoryservice)     | A TextParagraphProperties for formatting text lines in a view.                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [IEditorOperationsFactoryService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.operations.ieditoroperationsfactoryservice)                   | A IEditorOperations object for an ITextView.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [ITextSearchService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.operations.itextsearchservice)                                             | Searches a text snapshot.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [ITextStructureNavigatorSelectorService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.operations.itextstructurenavigatorselectorservice)     | An ITextStructureNavigator for an ITextBuffer by IContentType.                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [IOutliningManagerService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.outlining.ioutliningmanagerservice)                                  | An IOutliningManager for a text view.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [IGlyphService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.language.intellisense.iglyphservice)                                                 | A standard set of glyphs.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [IIntellisenseSessionStackMapService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.language.intellisense.iintellisensesessionstackmapservice)     | An IIntellisenseSessionStack for a ITextView.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [IWpfKeyboardTrackingService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.language.intellisense.iwpfkeyboardtrackingservice)                     | Tracks keyboard handling.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [IStandardClassificationService](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.language.standardclassification.istandardclassificationservice)     | Standard IClassificationType objects.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [ITextUndoHistoryRegistry](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.operations.itextundohistoryregistry)                                 | Maintains the relationship between text buffers and ITextUndoHistory objects.                                                                                                                                                                                                                                                                                                                                                                                                                                                              |

## Other imports

Provider factories and brokers are generally entities that can have multiple
instances in multiple components.

| OTHER IMPORTS                                                                                                                               |                                                                   |
|---------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------|
| Import                                                                                                                                      | Provides                                                          |
| [IErrorProviderFactory](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.adornments.ierrorproviderfactory)           | A SimpleTagger\<T\> of type ErrorTag) for the given buffer.       |
| [ITextMarkerProviderFactory](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.adornments.itextmarkerproviderfactory) | A text marker tagger (a SimpleTagger\<T\> of type TextMarkerTag). |
| [IToolTipProviderFactory](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.text.adornments.itooltipproviderfactory)       | An IToolTipProvider for a given ITextView.                        |
| [ICompletionBroker](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.language.intellisense.icompletionbroker)             | An ICompletionSession.                                            |
| [IQuickInfoBroker](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.language.intellisense.iquickinfobroker)               | An IQuickInfoSession.                                             |
| [ISignatureHelpBroker](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.language.intellisense.isignaturehelpbroker)       | An ISignatureHelpSession.                                         |

## See also

[Language service and editor extension
points](https://docs.microsoft.com/en-us/visualstudio/extensibility/language-service-and-editor-extension-points?view=vs-2022)
